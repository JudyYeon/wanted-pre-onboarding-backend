# 🧩 샤딩(Sharding)이란?

## ✅ 정의

- **샤딩(Sharding)**은 **데이터를 여러 개의 분산된 저장소(서버, 노드)에 나누어 저장하는 기술**입니다.
- 말 그대로 데이터를 "조각(shard)" 내서 나누는 것.
- 주로 **수평 확장**을 위해 사용되며, 각 샤드는 전체 데이터의 일부분만 저장합니다.

> 즉, "한 대의 데이터베이스가 모든 데이터를 다 담기 어려워지면 → 여러 대로 나눠서 저장"

---

## 📦 예시

### ✅ 전체 고객 테이블 예시

| 고객ID | 이름     | 이메일               |
|--------|----------|----------------------|
| 1      | 홍길동   | gil@example.com      |
| 2      | 김철수   | cheol@example.com    |
| 3      | 이영희   | young@example.com    |
| ...    | ...      | ...                  |

### ➡️ 샤딩 적용 후 (고객 ID 기준 분산)

- **Shard 1**: 고객ID 1~100000
- **Shard 2**: 고객ID 100001~200000
- **Shard 3**: 고객ID 200001~

> 각 DB는 전체의 일부만 저장하며, 전체가 하나처럼 동작

---

## 📌 샤딩과 파티셔닝의 차이?

| 구분         | 파티셔닝 (Partitioning)         | 샤딩 (Sharding)                         |
|--------------|----------------------------------|------------------------------------------|
| 위치         | **같은 서버/DB 내부** 파티션    | **서로 다른 서버/노드**에 분산           |
| 사용 목적     | 저장 효율성, 인덱스 최적화       | **수평 확장**, 성능 및 용량 분산          |
| 범위         | 내부 구조 개선                  | **분산 시스템 구현**                      |

---

## 🧠 샤딩의 방식

### 1. 📛 해시 기반 샤딩
- 특정 컬럼(ex. 사용자 ID)의 해시 값을 기준으로 나눔
- 데이터가 고르게 분산되지만, 범위 조회가 어려울 수 있음

### 2. 🧭 범위 기반 샤딩
- ID 범위나 날짜 등 특정 기준으로 분산
- 범위 쿼리에 유리하지만 데이터 불균형(쏠림) 발생 가능

### 3. 🌍 지역 기반 샤딩
- 사용자 지역, 국가 등 물리적 구분 기준으로 나눔
- 로컬 성능 향상, 지역별 법률 준수 등에도 유리

---

## ⚙️ 샤딩의 구성 요소

| 구성 요소    | 설명 |
|-------------|------|
| **Shard**    | 실제 데이터를 저장하는 물리적 노드 |
| **Config Server** | 어떤 데이터가 어떤 샤드에 있는지 메타정보를 저장 |
| **Query Router (mongos 등)** | 사용자의 요청을 적절한 샤드로 라우팅 |

---

## ✅ 샤딩의 장점

- 데이터베이스 **수평 확장** 가능
- **대용량 데이터** 처리에 적합
- 부하 분산 및 처리 속도 향상

---

## ❗️샤딩의 단점

- 구현과 운영이 복잡 (장애 처리, 라우팅 로직 등)
- **분산 트랜잭션** 처리 어려움 (ACID 보장 어려움)
- Join, Aggregation 등 복잡한 연산이 느릴 수 있음
- 샤딩 키 선정이 매우 중요

---

## 🔚 정리

- **샤딩**은 데이터를 나누어 여러 서버에 저장하는 방식
- 대용량 데이터 처리 및 수평 확장을 가능하게 해주는 핵심 기술
- 잘 설계하면 성능 향상, 잘못 설계하면 복잡성과 병목 발생

